!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).Pristine=r()}(this,function(){"use strict";var lang={required:"This field is required",email:"This field requires a valid e-mail address",number:"This field requires a number",integer:"This field requires an integer number",url:"This field requires a valid website URL",tel:"This field requires a valid telephone number",maxlength:"This fields length must be < ${1}",minlength:"This fields length must be > ${1}",min:"Minimum value for this field is ${1}",max:"Maximum value for this field is ${1}",pattern:"Input must match the pattern ${1}",zipcode:"This field requires a valid ZIP code",pwdmatch:"The two passwords don't match",minage:"The user must be at least ${1} years old",validate:"Condition not satisfied: ${1}"};function findAncestor(e,r){for(;(e=e.parentElement)&&!e.classList.contains(r););return e}function tmpl(e){var t=arguments;return this.replace(/\${([^{}]*)}/g,function(e,r){return t[r]})}function groupedElemCount(e){return e.pristine.self.form.querySelectorAll('input[name="'+e.getAttribute("name")+'"]:checked').length}function mergeConfig(e,r){for(var t in r)t in e||(e[t]=r[t]);return e}var defaultConfig={classTo:"form-group",errorClass:"has-danger",successClass:"has-success",errorTextParent:"form-group",errorTextTag:"div",errorTextClass:"text-help"},PRISTINE_ERROR="pristine-error",SELECTOR="input:not([type^=hidden]):not([type^=submit]), select, textarea",ALLOWED_ATTRIBUTES=["required","min","max","minlength","maxlength","pattern","integer","zipcode","pwdmatch","minage","validate"],validators={},_=function(e,r){r.name=e,r.msg||(r.msg=lang[e]),void 0===r.priority&&(r.priority=1),validators[e]=r};function Pristine(e,r,t){var n,i,s,o=this;function a(e,r,t,n){var i=validators[t];if(i&&(e.push(i),n)){var s=n.split(",");s.unshift(null),r[t]=s}}function l(e){var r=[],t=!0;for(var n in e.validators){var i=e.validators[n],s=e.params[i.name]?e.params[i.name]:[];if(s[0]=e.input.value,!i.fn.apply(e.input,s)){t=!1;var a=e.messages[i.name]||i.msg;if(r.push(tmpl.apply(a,s)),!0===i.halt)break}}return e.errors=r,t}function u(e){if(e.errorElements)return e.errorElements;var r=findAncestor(e.input,o.config.classTo),t=null,n=null;return(t=o.config.classTo===o.config.errorTextParent?r:r.querySelector(o.errorTextParent))&&((n=t.querySelector("."+PRISTINE_ERROR))||((n=document.createElement(o.config.errorTextTag)).className=PRISTINE_ERROR+" "+o.config.errorTextClass,t.appendChild(n),n.pristineDisplay=n.style.display)),e.errorElements=[r,n]}function f(e){var r=u(e),t=r[0],n=r[1];t&&(t.classList.remove(o.config.successClass),t.classList.add(o.config.errorClass)),n&&(n.innerHTML=e.errors.join("<br/>"),n.style.display=n.pristineDisplay||"")}return i=r,s=t,(n=e).setAttribute("novalidate","true"),o.form=n,o.config=mergeConfig(i||{},defaultConfig),o.live=!(!1===s),o.fields=Array.from(n.querySelectorAll(SELECTOR)).map(function(e){var t=[],n={},i={};return[].forEach.call(e.attributes,function(e){if(/^data-pristine-/.test(e.name)){var r=e.name.substr(14);if(r.endsWith("-message"))return void(i[r.slice(0,r.length-8)]=e.value);"type"===r&&(r=e.value),a(t,n,r,e.value)}else~ALLOWED_ATTRIBUTES.indexOf(e.name)?a(t,n,e.name,e.value):"type"===e.name&&a(t,n,e.value)}),t.sort(function(e,r){return r.priority-e.priority}),o.live&&e.addEventListener(~["radio","checkbox"].indexOf(e.getAttribute("type"))?"change":"input",function(e){o.validate(e.target)}.bind(o)),e.pristine={input:e,validators:t,params:n,messages:i,self:o}}.bind(o)),o.validate=function(e,r){r=e&&!0===r||!0===e;var t=o.fields;!0!==e&&!1!==e&&(e instanceof HTMLElement?t=[e.pristine]:(e instanceof NodeList||e instanceof(window.$||Array)||e instanceof Array)&&(t=Array.from(e).map(function(e){return e.pristine})));var n,i=!0;for(var s in t){var a=t[s];l(a)?!r&&(n=void 0,(n=function(e){var r=u(e),t=r[0],n=r[1];t&&(t.classList.remove(o.config.errorClass),t.classList.remove(o.config.successClass));n&&(n.innerHTML="",n.style.display="none");return r}(a)[0])&&n.classList.add(o.config.successClass)):(i=!1,!r&&f(a))}return i},o.getErrors=function(e){if(e)return e.length?e[0].pristine.errors:e.pristine.errors;for(var r=[],t=0;t<o.fields.length;t++){var n=o.fields[t];n.errors.length&&r.push({input:n.input,errors:n.errors})}return r},o.addValidator=function(e,r,t,n,i){e instanceof HTMLElement?(e.pristine.validators.push({fn:r,msg:t,priority:n,halt:i}),e.pristine.validators.sort(function(e,r){return r.priority-e.priority})):console.warn("The parameter elem must be a dom element")},o.addError=function(e,r){(e=e.length?e[0]:e).pristine.errors.push(r),f(e.pristine)},o.reset=function(){for(var e in o.fields)o.fields[e].errorElements=null;Array.from(o.form.querySelectorAll("."+PRISTINE_ERROR)).map(function(e){e.parentNode.removeChild(e)}),Array.from(o.form.querySelectorAll("."+o.config.classTo)).map(function(e){e.classList.remove(o.config.successClass),e.classList.remove(o.config.errorClass)})},o.destroy=function(){o.reset(),o.fields.forEach(function(e){delete e.input.pristine}),o.fields=[]},o.setGlobalConfig=function(e){defaultConfig=e},o}return _("text",{fn:function(e){return!0},priority:0}),_("required",{fn:function(e){return"radio"===this.type||"checkbox"===this.type?groupedElemCount(this):void 0!==e&&""!==e},priority:99,halt:!0}),_("email",{fn:function(e){return!e||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}}),_("number",{fn:function(e){return!e||!isNaN(parseFloat(e))},priority:2}),_("integer",{fn:function(e){return!e||/^\d+$/.test(e)}}),_("minlength",{fn:function(e,r){return!e||e.length>=parseInt(r)}}),_("maxlength",{fn:function(e,r){return!e||e.length<=parseInt(r)}}),_("min",{fn:function(e,r){return!e||("checkbox"===this.type?groupedElemCount(this)>=parseInt(r):parseFloat(e)>=parseFloat(r))}}),_("max",{fn:function(e,r){return!e||("checkbox"===this.type?groupedElemCount(this)<=parseInt(r):parseFloat(e)<=parseFloat(r))}}),_("pattern",{fn:function(e,r){var t=r.match(new RegExp("^/(.*?)/([gimy]*)$"));return!e||new RegExp(t[1],t[2]).test(e)}}),_("zipcode",{fn:function(e){return!e||/^[0-9]{5}(?:-[0-9]{4})?$/.test(e)}}),_("pwdmatch",{fn:function(e,r){var t=document.getElementById(r).value;return!t&&!e||t===e}}),_("minage",{fn:function(e,r){if(!e)return!0;var t=new Date(e),n=new Date,i=new Date(n.getFullYear(),t.getMonth(),t.getDate()),s=n.getFullYear()-t.getFullYear();return r<s||s==r&&i<=n}}),_("validate",{fn:function fn(val,condition){if(!val||!condition)return!0;for(var i=2;i<arguments.length;i++){var fieldId=arguments[i].trim(),assignment="parameters['"+fieldId+"'] = document.getElementById('"+fieldId+"').value";eval(assignment),condition=condition.replace(new RegExp("\\b"+fieldId+"\\b"),"parameters['"+fieldId+"']")}return eval(condition)}}),Pristine.addValidator=function(e,r,t,n,i){_(e,{fn:r,msg:t,priority:n,halt:i})},Pristine});
